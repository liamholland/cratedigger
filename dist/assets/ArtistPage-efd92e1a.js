import{g as N,h as g,c as L,r as p,i as b,m as k,k as A,j as w,u as S,T as R,a as y}from"./TheFooter-e0d3c608.js";import{_ as I,o as n,c as r,b as s,t as h,F as x,i as P,g as $,p as T,h as B,d as m}from"./index-ae2f5c21.js";const _=N(L),D=g(_,"getSpotifyToken"),F=g(_,"getArtist"),G=g(_,"getAlbums"),U=g(_,"getRelatedArtists"),M=g(_,"getUnrelatedArtists"),v=g(_,"updateProfile"),O={data(){return{artistName:"",genres:"",albums:[],mostRelated:"",leastRelated:"",lastSuggestedGenre:""}},created(){this.refresh(this.$route.params.aid,!1)},methods:{refresh(e,t){D().then(l=>{F({token:l.data.access_token,id:e}).then(a=>{this.artistName=a.data.name,this.genres="",a.data.genres.forEach(c=>{this.genres+=c+" , "}),G({token:l.data.access_token,id:e}).then(c=>{this.albums=c.data.items.sort(this.compareDates),t||U({token:l.data.access_token,id:e}).then(i=>{let o=0;do if(this.mostRelated=i.data.artists[o],o++,o==20){this.refresh(i.data.artists[19].id,!1);return}while(p(this.mostRelated.id));M({token:l.data.access_token,limit:20,genres:a.data.genres,backup:this.lastSuggestedGenre}).then(u=>{console.log(u.data),this.lastSuggestedGenre=u.data.genre;let f=0;do this.leastRelated=u.data.artists[f],f++;while(p(this.leastRelated.id))}).catch(u=>{console.log(u)})}).catch(i=>{console.log(i)})}).catch(c=>{console.log(c)})}).catch(a=>{console.log(a)})}).catch(l=>{console.log(l)})},toggleLikeAlbum(e){if(b()){let t=A();if(t.likedAlbums.find(l=>l.id==e.id)){t.likedAlbums.splice(t.likedAlbums.indexOf(e),1);let l=t.likedAlbums;v({id:k(),field:"likedAlbums",value:l}).then(a=>{this.refresh(this.$route.params.aid,!0)}).catch(a=>{console.log(a)}),w(t)}else{t.likedAlbums.push(e);let l=t.likedAlbums;v({id:k(),field:"likedAlbums",value:l}).then(a=>{this.refresh(this.$route.params.aid,!0)}).catch(a=>{console.log(a)}),w(t)}}else console.log("Not Logged In")},isRepeat(e){let t=this.albums.indexOf(e);if(t==0)return!1;if(t!=-1){let l=this.albums[t-1];return e.name==l.name}},compareDates(e,t){let l=new Date(e.release_date),a=new Date(t.release_date);return l<a?-1:l>a?1:0},goToNewArtist(e){S(e),this.$router.push({name:"ArtistPage",params:{aid:e}}),this.refresh(e,!1)},isLiked(e){return b()?A().likedAlbums.find(t=>t.id==e.id):!1}}},d=e=>(T("data-v-a9f06a20"),e=e(),B(),e),V={class:"body"},j=d(()=>s("br",null,null,-1)),E={class:"artistName"},Z={class:"artistGenre"},z=d(()=>s("br",null,null,-1)),H=d(()=>s("br",null,null,-1)),q=d(()=>s("br",null,null,-1)),J=d(()=>s("br",null,null,-1)),K={style:{"background-color":"black"}},Q={key:0,class:"albumResult"},W=["src"],X={class:"albumInfo"},Y=["onClick"],ee={key:0,xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-heartbreak-fill",viewBox:"0 0 16 16"},te=d(()=>s("path",{d:"M8.931.586 7 3l1.5 4-2 3L8 15C22.534 5.396 13.757-2.21 8.931.586ZM7.358.77 5.5 3 7 7l-1.5 3 1.815 4.537C-6.533 4.96 2.685-2.467 7.358.77Z"},null,-1)),se=[te],le={key:1,xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-heart-fill",viewBox:"0 0 16 16"},ae=d(()=>s("path",{"fill-rule":"evenodd",d:"M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314z"},null,-1)),oe=[ae];function ie(e,t,l,a,c,i){return n(),r("section",V,[j,s("p",E,h(this.artistName),1),s("p",Z,h(this.genres),1),s("button",{class:"btn-get-started",onClick:t[0]||(t[0]=o=>i.goToNewArtist(this.mostRelated.id))},"Related Artist: "+h(this.mostRelated.name),1),s("button",{class:"btn-get-started",onClick:t[1]||(t[1]=o=>i.goToNewArtist(this.leastRelated.id))},"Unrelated Artist: "+h(this.leastRelated.name),1),z,H,q,J,s("ul",K,[(n(!0),r(x,null,P(this.albums,o=>(n(),r("li",null,[this.isRepeat(o)?$("",!0):(n(),r("div",Q,[s("img",{src:o.images[0].url,alt:"Album Cover"},null,8,W),s("div",X,[s("button",{onClick:u=>i.toggleLikeAlbum(o),type:"button",class:"btn btn-outline-danger",style:{position:"absolute",left:"72.5%"}},[i.isLiked(o)?(n(),r("svg",ee,se)):(n(),r("svg",le,oe))],8,Y),s("h1",null,h(o.name),1),s("h3",null,h(o.release_date),1)])]))]))),256))])])}const C=I(O,[["render",ie],["__scopeId","data-v-a9f06a20"]]),ne={class:"wrapper"},re={name:"ArtistPage",components:{TheHeader:R,ArtistPageBody:C,TheFooter:y}},ue=Object.assign(re,{setup(e){return(t,l)=>(n(),r(x,null,[s("header",null,[m(R),s("div",ne,[m(C)])]),s("main",null,[m(y)])],64))}});export{ue as default};
